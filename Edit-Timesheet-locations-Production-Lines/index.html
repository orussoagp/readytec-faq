<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Edit Timesheet locations (Production Lines)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    html, body { margin:0; padding:0; height:100%; background:#fff; font-family:Arial, sans-serif; }
    .wrap { width:100%; max-width:100%; margin:0 auto; }
    /* Let JS set exact height; keep sensible minimum to avoid short frames */
    #scribe { display:block; width:100%; min-height:750px; border:0; }
  </style>
</head>
<body>
  <div class="wrap">
    <iframe
      id="scribe"
      src="https://scribehow.com/embed/Edit_Timesheet_locations_Production_Lines__yCkJxv_7R6yfU0Odu6D7Pw?as=scrollable"
      allow="fullscreen"
      loading="eager">
    </iframe>
  </div>

  <script>
    /* --- SCORM 1.2 minimal runtime --- */
    var API=null, sessionStartTime, sessionTimerInterval;
    function findAPI(w){ if(w.API && typeof w.API==="object") return w.API;
      if(w.parent && w.parent!==w) return findAPI(w.parent);
      if(w.opener && w.opener!==null && w.opener!==w) return findAPI(w.opener);
      return null;
    }
    function getAPI(){ if(API) return API; API=findAPI(window); if(API===null && window.opener) API=findAPI(window.opener); return API; }
    function initializeSCORM(){ const api=getAPI(); if(!api) return;
      api.LMSInitialize(""); api.LMSSetValue("cmi.core.lesson_status","incomplete");
      sessionStartTime=new Date(); sessionTimerInterval=setInterval(function(){
        const sec=Math.floor((new Date()-sessionStartTime)/1000);
        const hh=String(Math.floor(sec/3600)).padStart(2,"0");
        const mm=String(Math.floor((sec%3600)/60)).padStart(2,"0");
        const ss=String(sec%60).padStart(2,"0");
        api.LMSSetValue("cmi.core.session_time", `${hh}:${mm}:${ss}`);
      },3000);
    }
    function terminateSCORM(){ const api=getAPI(); if(!api) return;
      clearInterval(sessionTimerInterval); api.LMSFinish("");
    }
    function completeSCO(){ const api=getAPI(); if(!api) return;
      api.LMSSetValue("cmi.core.lesson_status","completed"); api.LMSCommit("");
    }
    window.addEventListener("load", initializeSCORM);
    window.addEventListener("unload", terminateSCORM);

    /* --- Dynamic height to reduce LMS scaling blur --- */
    function resizeFrame(){
      var h = Math.max(750, window.innerHeight || document.documentElement.clientHeight || 750);
      // Subtract any known LMS chrome if needed; start with none.
      document.getElementById('scribe').style.height = h + 'px';
    }
    window.addEventListener('load', resizeFrame);
    window.addEventListener('resize', resizeFrame);
  </script>
</body>
</html>
